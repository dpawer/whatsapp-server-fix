[phases.setup]
nixPkgs = [
    "nodejs_22",
    "chromium",
    "nss",
    "atk",
    "at-spi2-atk",
    "cups",
    "libdrm",
    "mesa",
    "alsa-lib",
    "pango",
    "libxscrnsaver",
    "gtk3",
    "libglvnd",
    "glu"
]

[phases.setup.apt]
pkgs = [
    "libnss3",
    "libatk1.0-0",
    "libatk-bridge2.0-0", 
    "libcups2",
    "libgbm1",
    "libasound2t64",
    "libpangocairo-1.0-0",
    "libxss1",
    "libgtk-3-0",
    "libxshmfence1",
    "libglu1-mesa",
    "chromium",
    "chromium-common",
    "chromium-driver"
]

[phases.install]
cmds = ["npm install --legacy-peer-deps"]

[phases.build]
cmds = ["npm run build"]

[start]
cmd = "node server.js"
